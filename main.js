(()=>{"use strict";class e{constructor(e,t){this.name=e,this.number=t}}class t{constructor(e,t,s,n,c,o){this.title=e,this.description=t,this.date=s,this.priority=n,this.now=c,this.createBy=o}static getTask(){let e;return e=null===localStorage.getItem("tasks")?[]:JSON.parse(localStorage.getItem("tasks")),e}static storeTask(e){const s=t.getTask();s.push(e),localStorage.setItem("tasks",JSON.stringify(s))}}class s{static delay(){setTimeout((()=>{window.location.reload()}),3e3)}static renderColours(e){return"high"===e?"#FF33F9":"medium"==e?" #334FFF":"low"===e?"#C70039":void 0}static getProjectName(){let e;return e=null===localStorage.getItem("projects")?[]:JSON.parse(localStorage.getItem("projects")),e}static getSelected(){let e;return e=null===localStorage.getItem("selectedId")?[]:JSON.parse(localStorage.getItem("selectedId")),e}static storeSelected(e){const t=s.getSelected();for(;t.length>0;)t.pop();t.push(e),localStorage.setItem("selectedId",JSON.stringify(t))}static storeProjectName(e){const t=s.getProjectName();t.push(e),localStorage.setItem("projects",JSON.stringify(t))}static countProject(){let e=Number(localStorage.getItem("lastProjectId"));return null===e?e=1:(e+=1,localStorage.setItem("lastProjectId",e)),e}static addActiveProjectTask(){const e=t.getTask(),n=s.getProjectName();let c=parseInt(s.getSelected()[0])||0;c=c||0;const o=document.getElementById("section-1");o.innerHTML="";const a=document.createElement("div"),d=document.createElement("h4");if(0!=e.length){e.forEach((e=>{if(e.createBy===n[c].name){o.classList.remove("d-none"),o.classList.add("d-block","mt-3");const t=document.createElement("h5");t.innerHTML=e.title,a.classList.add("d-flex","flex-wrap","justify-content-around"),a.id=e.id,t.classList.add("text-success","bg-grey","card-title");const n=document.createElement("div");n.classList.add("card");const c=document.createElement("div");c.classList.add("card-body");const r=document.createElement("p");r.innerHTML=e.date;const l=document.createElement("div"),i=document.createElement("span");i.innerHTML='<i class="fas fa-edit"></i>',i.id=e.now,i.setAttribute("onclick",`editTask(${e.now})`);const m=document.createElement("span");m.innerHTML='<i class="fas ml-5 fa-trash-alt" ></i>',m.id=e.now,m.setAttribute("onclick",`removeTask(${e.now})`),m.classList.add("text-danger"),r.classList.add("card-text");const u=document.createElement("p");u.innerHTML=e.description,n.style.background=`${s.renderColours(e.priority)}`,d.innerHTML=e.createBy,d.classList.add("text-center"),l.appendChild(i),l.appendChild(m),c.appendChild(t),c.appendChild(u),c.appendChild(r),c.appendChild(l),n.appendChild(c),a.appendChild(n),o.appendChild(a);let g=!1;c.addEventListener("click",(()=>{!1===g?(c.classList.add("bg-dark"),g=!0):(c.classList.remove("bg-dark"),g=!1)}))}}));const t=document.createElement("div");t.innerHTML="+",t.style.right="-330px",t.style.top="-80%",t.style.bottom="-500px",t.style.position="relative",t.style.cursor="pointer",t.style.fontSize="50px",o.appendChild(a),o.insertBefore(d,o.firstChild),o.appendChild(t),t.addEventListener("click",(()=>{const e=document.getElementById("task-form");e.classList.remove("d-none"),e.classList.add("d-block")}))}}static renderDefault(){if(0===s.getProjectName().length){const t=new e("default",0);s.storeProjectName(t)}const t=s.getProjectName(),n=document.getElementById("sideNavListchild"),c=document.createElement("li");c.innerHTML=`${t[0].name}`,c.classList.add("text-white","text-center","list-unstyled"),c.style.cursor="pointer",c.addEventListener("click",(()=>{s.synchro(c),s.addActiveProjectTask()})),n.appendChild(c),document.getElementById("section-1").innerHTML="",s.addActiveProjectTask()}static showAlert(e,t){const s=document.createElement("div");s.className=`alert alert-${t} text-center`,s.appendChild(document.createTextNode(e)),document.querySelector("#section-1").appendChild(s)}static synchro(e){const t=document.getElementById("section-1");t.innerHTML="",t.classList.remove("d-none"),t.classList.add("d-block"),document.getElementById("add-class-header");const s=document.createElement("h4"),n=document.createElement("div"),c=document.createElement("div");c.innerHTML="+",c.style.right="0px",c.style.bottom="0px",c.style.position="relative",c.style.cursor="pointer",c.style.fontSize="50px",c.style.cursor="pointer",n.innerHTML="Add task",n.appendChild(c),s.innerHTML=e.textContent,c.addEventListener("click",(()=>{const e=document.getElementById("task-form");e.classList.remove("d-none"),e.classList.add("d-block")})),n.appendChild(c),t.appendChild(n),t.insertBefore(s,n)}static displayAddTask(){const e=document.getElementById("section-1");e.classList.remove("d-none"),e.classList.add("d-block")}static renderSelected(e){const t=s.getProjectName(),n=document.getElementById("sideNavListchild");n.innerHTML="",s.renderDefault(),t.forEach((t=>{if(0!=t.number){const c=document.createElement("li");c.innerHTML=`${t.name}<i class="fas ml-5 fa-trash-alt" ></i>`,c.classList.add("text-white","text-center","mt-4","list-unstyled"),c.id=t.number,parseInt(e[0])===parseInt(c.id)&&(c.classList.add("text-danger"),s.synchro(c)),c.style.cursor="pointer",n.appendChild(c),c.children[0].setAttribute("onclick",`removeProject(${t.number})`)}}))}static renderRefresh(){const e=s.getSelected();s.renderSelected(e)}static addProjectName(){const e=s.getProjectName(),t=document.getElementById("sideNavListchild");t.innerHTML="",e.forEach((e=>{if(0!=e.number){const n=document.createElement("li");n.innerHTML=`${e.name}<i class="fas ml-5 fa-trash-alt" ></i>`,n.classList.add("text-white","text-center","mt-4","list-unstyled"),n.id=e.number,n.style.cursor="pointer",t.appendChild(n),t.addEventListener("click",(e=>{if("li"===e.target.tagName.toLowerCase()){s.displayAddTask(),s.storeSelected(e.target.id);const t=s.getSelected();s.renderSelected(t);const n=document.getElementById("task-form");n.classList.remove("d-block"),n.classList.add("d-none"),e.target.setAttribute("onclick",s.synchro(e.target))}})),n.children[0].setAttribute("onclick",`removeProject(${e.number})`)}}))}}document.getElementById("section-1").classList.add("d-none"),window.removeProject=e=>{const n=s.getProjectName(),c=s.getSelected(),o=t.getTask();o.forEach(((t,s)=>{console.log(t.createBy),console.log(n[parseInt(e)]),t.createBy===n[parseInt(e)].name&&(console.log("yes"),o.splice(s,1),localStorage.setItem("tasks",JSON.stringify(o)))})),c.pop(),s.storeSelected(c),n.forEach(((t,s)=>{t.number===e&&n.splice(s,1)})),document.getElementById(e).remove(),localStorage.setItem("projects",JSON.stringify(n)),s.addProjectName(),s.showAlert("Project Removed","success"),s.delay()},window.removeTask=e=>{const n=t.getTask();n.forEach(((t,c)=>{parseInt(t.now)===e&&(n.splice(c,1),document.getElementById(e).parentNode.parentNode.parentNode.remove(),localStorage.setItem("tasks",JSON.stringify(n)),s.showAlert("Task Removed","success"),s.delay())}))},window.editTask=e=>{let s,n;const c=t.getTask();c.forEach(((t,o)=>{parseInt(t.now)===e&&(console.log("success"),s=e,n=t,c.splice(o,1),localStorage.setItem("tasks",JSON.stringify(c)))})),document.getElementById(e),document.getElementById("task-form").classList.remove("d-none"),document.getElementById("task-form").classList.add("d-block"),document.querySelector("#titletwo").value=n.title,document.getElementById("description").value=n.description,document.querySelector("#date").value=n.date},document.getElementsByClassName("close")[0].onclick=function(){document.getElementById("task-form").classList.remove("d-block"),document.getElementById("task-form").classList.add("d-none")},document.getElementById("project-form").addEventListener("submit",(t=>{t.preventDefault();const n=document.querySelector("#title").value;if(""===n)s.showAlert("Please fill in all fields","danger"),s.delay();else{const t=new e(n,s.countProject());s.storeProjectName(t),s.addProjectName(),s.showAlert("project added successfuly","success"),setTimeout((()=>{window.location.reload()}),3e3)}})),document.getElementById("task-form").addEventListener("submit",(e=>{e.preventDefault();const n=document.querySelector("#titletwo").value,c=document.getElementById("description").value,o=document.querySelector("#date").value,a=document.querySelector('input[name="priority"]:checked').value;if(""===n||""===c||""==o||null==a)s.showAlert("Please fill in all fields","danger"),setTimeout((()=>{window.location.reload()}),3e3);else{const e=s.getSelected(),d=s.getProjectName();if(0===e.length||0===e[0].length){const e=new t(n,c,o,a,Date.now().toString(),d[0].name);t.storeTask(e)}else{const s=new t(n,c,o,a,Date.now().toString(),d[parseInt(e[0])].name);t.storeTask(s)}s.showAlert("Task added successfuly","success"),s.delay()}})),document.addEventListener("DOMContentLoaded",s.addProjectName(),s.renderRefresh(),s.addActiveProjectTask())})();