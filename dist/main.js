(()=>{"use strict";class e{constructor(e,t){this.name=e,this.number=t,this.tasks=[]}}class t{static delay(){setTimeout((()=>{window.location.reload()}),3e3)}static setSelected(){return t.getSelected()}static getProjectName(){let e;return e=null===localStorage.getItem("projects")?[]:JSON.parse(localStorage.getItem("projects")),e}static getSelected(){let e;return e=null===localStorage.getItem("selectedId")?[0]:JSON.parse(localStorage.getItem("selectedId")),e}static renderColours(e){return"high"===e?"#FF33F9":"medium"===e?" #334FFF":"low"===e&&"#C70039"}static ActivOnRefresh(){null===localStorage.getItem("selectedActiveId")?selectedId=[0]:localStorage.setItem("selectedActiveId",JSON.stringify(t.setSelected()))}static storeSelected(e){const s=t.getSelected();s.pop(),s.push(e),0===s.length&&s.push(s[0]),localStorage.setItem("selectedId",JSON.stringify(s))}static countProject(){let e=Number(localStorage.getItem("lastProjectId"));return null===e?e=1:(e+=1,localStorage.setItem("lastProjectId",e)),e}static storeProjectName(e){const s=t.getProjectName();s.push(e),localStorage.setItem("projects",JSON.stringify(s))}static synchro(e){const s=Number(e.id),a=t.getProjectName()[s],c=document.createElement("div"),o=document.getElementById("section-1"),l=document.getElementById("add-class-header");l.innerHTML=e.textContent,o.innerHTML="",o.innerHTML="Todo list",l.innerHTML=e.textContent,o.appendChild(l),console.log("here"),console.log(JSON.parse(localStorage.getItem("selectedActiveId"))),a.tasks.forEach((e=>{const s=document.createElement("h5");s.innerHTML=e.title,c.classList.add("d-flex","flex-wrap","justify-content-around"),c.id=e.id,s.classList.add("text-success","bg-grey","card-title");const a=document.createElement("div");a.classList.add("card");const n=document.createElement("div");n.classList.add("card-body");const r=document.createElement("p");r.innerHTML=e.date;const d=document.createElement("div"),i=document.createElement("span");i.innerHTML='<i class="fas fa-edit"></i>',i.id=e.now,i.setAttribute("onclick",`editTask(${e.now})`);const m=document.createElement("span");m.innerHTML='<i class="fas ml-5 fa-trash-alt" ></i>',m.id=e.now,m.setAttribute("onclick",`removeTask(${e.now})`),m.classList.add("text-danger"),r.classList.add("card-text");const u=document.createElement("p");u.innerHTML=e.description,a.style.background=`${t.renderColours(e.priority)}`,l.innerHTML=e.createBy,l.classList.add("text-center"),d.appendChild(i),d.appendChild(m),n.appendChild(s),n.appendChild(u),n.appendChild(r),n.appendChild(d),a.appendChild(n),c.appendChild(a),o.appendChild(c)})),o.classList.remove("d-none"),o.classList.add("d-block");const n=document.getElementById("plus");n.style.display="block",n.addEventListener("click",(()=>{const e=document.getElementById("task-form");e.classList.remove("d-none"),e.classList.add("d-block")}))}static renderDefault(){if(0===t.getProjectName().length){const s=new e("default",0);t.storeProjectName(s)}const s=t.getProjectName(),a=(document.getElementById("sideNavListchild"),document.createElement("li"));return a.innerHTML=`${s[0].name}`,a.id="0",a.classList.add("text-white","text-center","list-unstyled"),a.style.cursor="pointer",a.addEventListener("click",(()=>{t.storeSelected(0),t.synchro(a)})),a}static addProjectName(){const e=t.getProjectName(),s=document.getElementById("sideNavListchild");s.innerHTML="",s.appendChild(t.renderDefault()),e.forEach((e=>{if(0!==e.number){const a=document.createElement("li");a.innerHTML=`${e.name}<i class="fas ml-5 fa-trash-alt" ></i>`,a.classList.add("text-white","text-center","mt-4","list-unstyled"),a.id=e.number,a.style.cursor="pointer",s.appendChild(a),s.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&0!==e.target.id&&(console.log(e.target.id),t.storeSelected(e.target.id),t.getSelected(),e.target.setAttribute("onclick",t.synchro(e.target)))})),a.children[0].setAttribute("onclick",`removeProject(${e.number})`)}}))}static showAlert(e,t){const s=document.createElement("div");s.className=`alert alert-${t} text-center`;const a=document.getElementById("alert");s.appendChild(document.createTextNode(e)),a.appendChild(s)}}class s{constructor(e,t,s,a,c,o){this.title=e,this.description=t,this.date=s,this.priority=a,this.now=c,this.createBy=o}static getTask(){let e;return e=null===localStorage.getItem("tasks")?[]:JSON.parse(localStorage.getItem("tasks")),e}static storeTask(e){const t=s.getTask();t.push(e),localStorage.setItem("tasks",JSON.stringify(t))}}window.removeProject=e=>{const s=t.getProjectName(),a=t.getSelected();let c;a.pop(),localStorage.setItem("selectedId",JSON.stringify(a)),s.forEach(((t,a)=>{t.number===e&&s.splice(a,1)})),document.getElementById(e).remove(),s.map(((e,t)=>{e.number=t,c=t})),console.log(c);let o=Number(localStorage.getItem("lastProjectId"));o=Number(c),localStorage.setItem("lastProjectId",JSON.stringify(o)),localStorage.setItem("projects",JSON.stringify(s)),t.addProjectName(),t.showAlert("Project Removed","success"),t.delay()},window.removeTask=e=>{const a=s.getTask();JSON.parse(localStorage.getItem("selectedId"));let c=t.getProjectName();c.map((t=>{t.tasks.map(((s,a)=>{Number(s.now)===e&&(t.tasks.splice(a,1),localStorage.setItem("projects",JSON.stringify(c)))}))})),a.map(((s,c)=>{Number(s.now)===e&&(a.splice(c,1),document.getElementById(e).parentNode.parentNode.parentNode.remove(),localStorage.setItem("tasks",JSON.stringify(a)),t.showAlert("Task Removed","success"),JSON.parse(localStorage.getItem("selectedId")),t.delay())}))},window.editTask=e=>{let a;const c=s.getTask();c.map(((t,s)=>{Number(t.now)===e&&(a=t,c.splice(s,1),localStorage.setItem("tasks",JSON.stringify(c)))})),JSON.parse(localStorage.getItem("selectedId"));let o=t.getProjectName();o.map((t=>{t.tasks.map(((s,a)=>{Number(s.now)===e&&(t.tasks.splice(a,1),localStorage.setItem("projects",JSON.stringify(o)))}))})),document.getElementById(e),document.getElementById("task-form").classList.remove("d-none"),document.getElementById("task-form").classList.add("d-block"),document.querySelector("#titletwo").value=a.title,document.getElementById("description").value=a.description,document.querySelector("#date").value=a.date},document.getElementsByClassName("close")[0].onclick=function(){document.getElementById("task-form").classList.remove("d-block"),document.getElementById("task-form").classList.add("d-none")},document.getElementById("project-form").addEventListener("submit",(s=>{s.preventDefault();const a=document.querySelector("#title").value;if(""===a)t.showAlert("Please fill in all fields","danger"),t.delay();else{const s=new e(a,t.countProject());t.storeProjectName(s),t.addProjectName(),t.showAlert("project added successfuly","success"),t.delay()}})),document.getElementById("task-form").addEventListener("submit",(e=>{e.preventDefault();const a=document.querySelector("#titletwo"),c=document.getElementById("description"),o=document.querySelector("#date"),l=document.querySelector('input[name="priority"]:checked');if(""===a.value||""===c.value||""===o.value||null===l)t.showAlert("Please fill in all fields","danger"),t.delay();else{const e=JSON.parse(localStorage.getItem("selectedId")),n=t.getProjectName();if(0===Number(e[0])){const t=new s(a.value,c.value,o.value,l,Date.now().toString(),n[0].name);s.storeTask(t),n[Number(e[0])].tasks.push(t),localStorage.setItem("projects",JSON.stringify(n))}else{const t=new s(a.value,c.value,o.value,l,Date.now().toString(),n[Number(e[0])].name);s.storeTask(t),n[Number(e[0])].tasks.push(t),localStorage.setItem("projects",JSON.stringify(n))}t.showAlert("Task added successfuly","success"),t.delay()}}));const a=t.getSelected();t.storeSelected(a),document.addEventListener("DOMContentLoaded",t.addProjectName())})();